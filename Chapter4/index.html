<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="./index.css">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>인재영입</title>
</head>
<body>
  <div id="main-img-wrapper">
    <img width="320" src="./Lovepik_com-401339128-data-management-data-analysis-icon-free-vector-illustration-mate.png"
      alt="coding image">
  </div>
  <div id="intro-main">
    <p>이미 모두의 은행, 패스트뱅크</p>
    <p>함께 일해요.</p>
    <p id="join-us-text">Join us!</p>
    <img id="down-arrow-icon" src="./down-arrow.png" alt="down arrow icon">
  </div>
  <ul id="list-item-wrapper">
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
    <li class="list-item">26주적금</li>
    <li class="list-item">저금</li>
    <li class="list-item">패스트캠퍼스</li>
    <li class="list-item">떡볶이</li>
    <li class="list-item">치킨</li>
    <li class="list-item">축구</li>
    <li class="list-item">축구선수</li>
    <li class="list-item">마이너스통장대출</li>
  </ul>

  <main>
    <section id="panel1-img">
      <img id="flying-santa-image" src="./santa_flying.png" alt="santa flying">
    </section>
    <section id="video-section">
      <div id="fixed-wrapper">
        <video src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" id="video"
        type="video/mp4" muted loop></video>
        <div id="fixed-description">
          <div>혁신이 만든</div>
          <div>압도적인 성장</div>
        </div>
      </div>
    </section>
    <div id="bank-beyond-wrapper">
      <div id="bank-beyond">
        <img src="./05-text.png" alt="sample text" width="315">
      </div>
    </div>
    <div id="white-wrapper">
      
    </div>
  </main>

</body>
<script>
  //4-2. 스크롤에 다라서 텍스트의 클래스 동적 제어
  const listSytleChangeStartY = 373;
  const listSytleChangeEndY = 1585;

  const listItems = document.querySelectorAll(".list-item");

  const division = (listSytleChangeEndY - listSytleChangeStartY) / listItems.length;

  // 산타 이미지 패널
  const panel1Img = document.getElementById("panel1-img");
  const flyingSantaImage = document.getElementById("flying-santa-image");

  // 비디오 (4-5)
  const videoPlayBack = 500;
  const videoElement = document.getElementById("video");
  const videoSection = document.getElementById("video-section");

  const fixedWrapper = document.getElementById("fixed-wrapper");
  const fixedDescription = document.getElementById("fixed-description");

  function centerElement(elementId, video) {
    const el = document.getElementById(elementId);
    const parent = el.parentElement; 

    if(window.scrollY > parent.offsetTop - ((document.documentElement.clientHeight - el.offsetHeight) / 2)) {
      el.style.position = "fixed";
      el.style.top = "50%";
      el.style.left = "50%";
      el.style.transform = "translate(-50%, -50%)";

      // 스크롤에 따라 비디오 재생
      if(video) video.currentTime = (window.scrollY - videoSection.offsetTop) / videoPlayBack;
    } else {
      el.style.position = "relative";
      el.style.top = "initial";
      el.style.left = "initial";
      el.style.transform = "initial";
    }
  }

  // 비디오 영역 높이* (재상 관련)
  videoElement.addEventListener("loadedmetadata", () => {
    document.getElementById("video-section").style.height = videoElement.duration * videoPlayBack + "px";
  })

  // 비디오 영역 아래 텍스트 등장 범위 
  const fixedDescriptionAppearStart = 3470;
  const fixedDesciptionAppearEnd = 3800;

  window.addEventListener("scroll", () => {
      console.log(window.scrollY);
      const tagHasOnClass = document.getElementById("on");
      if(tagHasOnClass) {
        tagHasOnClass.removeAttribute("id");
      }

      if(window.scrollY > listSytleChangeStartY && window.scrollY < listSytleChangeEndY) {
        const index = Math.round((window.scrollY - listSytleChangeStartY) / division);

        if(listItems[index]) listItems[index].setAttribute("id", "on");
      }

      // 산타 패널 스크롤 이벤트 
      const scrollYBottom = window.scrollY + document.documentElement.clientHeight;
      if (scrollYBottom > panel1Img.offsetTop && scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight + 100) {
        const translateX = 80 - 80 * 1.3 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);
        const translateY = -13 + 13 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);

        const rotationDegree = 10 - 9 * 1.1 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);

        flyingSantaImage.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`;
      }

      centerElement("fixed-wrapper", videoElement); // 특정 위치 비디오 고정

      // 비디오 섹션이 끝났을 때
      if(window.scrollY > videoSection.offsetTop + videoSection.offsetHeight - (fixedWrapper.offsetHeight + (document.documentElement.clientHeight - fixedWrapper.offsetHeight) / 2)) {
        fixedWrapper.style.position = "relative";
        fixedWrapper.style.top = "initial";
        fixedWrapper.style.left = "initial";
        fixedWrapper.style.transform = `translateY(${videoSection.offsetHeight - fixedWrapper.offsetHeight}px)`;
      }

      // 비디오 아래 텍스트 opacity 조절
      if(window.scrollY > fixedDescriptionAppearStart && window.scrollY < fixedDesciptionAppearEnd) {
        // translateY 가 0으로 올라오면서 opacity 1로 수렴
        fixedDescription.style.transform = `translateY(${fixedDesciptionAppearEnd - window.scrollY}px)`;
        fixedDescription.style.opacity = (window.scrollY - fixedDescriptionAppearStart) / 300;
      } else if(window.scrollY > fixedDesciptionAppearEnd) {
        // 영역 넘어간 경우 위에 고정
        fixedDescription.style.transform = `translateY(0px)`;
        fixedDescription.style.opacity = 1;
      } else {
        // 초기화 - 숨김처리
        fixedDescription.style.transform = `translateY(100px)`;
        fixedDescription.style.opacity = 0;
      }

      centerElement("bank-beyond");
    });
</script>
</html>